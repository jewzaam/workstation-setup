---
# Generated By: Cursor (Claude Sonnet 4)
# Files deployment tasks - supports individual files and recursive directories

- name: Create directories for individual files
  ansible.builtin.file:
    path: "{{ user_home }}/{{ item.dest | dirname }}"
    state: directory
    mode: "0755"
    owner: "{{ user_name }}"
    group: "{{ user_name }}"
  loop: "{{ files }}"
  when:
    - item.dest | dirname != '.'
    - item.type | default('file') == 'file'

- name: Deploy individual files to user home directory
  ansible.builtin.copy:
    src: "{{ item.src }}"
    dest: "{{ user_home }}/{{ item.dest }}"
    mode: "{{ item.mode }}"
    owner: "{{ user_name }}"
    group: "{{ user_name }}"
    backup: false
    force: "{{ not item.user_managed }}"
  loop: "{{ files }}"
  when: item.type | default('file') == 'file'

- name: Deploy directories recursively to user home directory
  ansible.builtin.copy:
    src: "{{ item.src }}/"
    dest: "{{ user_home }}/{{ item.dest }}/"
    mode: preserve
    owner: "{{ user_name }}"
    group: "{{ user_name }}"
    backup: false
    force: "{{ not item.user_managed | default(false) }}"
  loop: "{{ files }}"
  when: item.type | default('file') == 'directory'
